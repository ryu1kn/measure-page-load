#!/usr/bin/env node

const fs = require('fs');
const crawl = require('../index');
const argv = require('minimist')(process.argv.slice(2));

crawl(argv)
    .then(processResult)
    .catch(e => {
        setTimeout(() => {
            throw e;
        }, 0);
    });

function processResult(result) {
    const data = JSON.stringify(result, true, 2);
    fs.writeFileSync(argv.output, data, 'utf8');
}
